# Add these lines to your existing nginx config for staging.konty.com

# ADD THIS AFTER THE "charset utf-8;" LINE (around line 26):

    # Basic Authentication for staging protection
    auth_basic "Staging Area - Restricted Access";
    auth_basic_user_file /etc/nginx/.htpasswd-staging;


# MODIFY YOUR EXISTING SECTIONS TO DISABLE AUTH FOR SPECIFIC ENDPOINTS:

    # API routes - proxy directly without trying files
    location /api/ {
        # ADD THIS LINE to allow health checks without auth
        location = /api/health {
            auth_basic off;
        }
        location = /api/ping {
            auth_basic off;
        }
        
        # ... rest of your existing proxy configuration ...
        proxy_pass http://127.0.0.1:3002;
        # ... etc ...
    }

    location = /robots.txt {
        auth_basic off;  # ADD THIS LINE - Allow robots.txt without auth
        expires 1d;
        access_log off;
        log_not_found off;
        try_files $uri @nuxt;
    }


# That's it! Only 3 additions:
# 1. Two lines for basic auth configuration
# 2. Disable auth for health/ping endpoints (for monitoring)
# 3. Disable auth for robots.txt (to prevent search engine indexing)